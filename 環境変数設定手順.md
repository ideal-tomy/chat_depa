# 環境変数設定手順

## 問題の原因

現在のエラーは環境変数が設定されていないことが原因です。以下の手順で環境変数を設定してください。

## 必要な環境変数

### 1. `.env.local` ファイルを作成

プロジェクトのルートディレクトリ（package.jsonと同じ階層）に `.env.local` ファイルを作成し、以下の内容を記載してください：

```bash
# Supabase Settings
NEXT_PUBLIC_SUPABASE_URL=your_supabase_url_here
NEXT_PUBLIC_SUPABASE_ANON_KEY=your_supabase_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key_here

# OpenAI Settings
OPENAI_API_KEY=your_openai_api_key_here

# NextAuth Settings (オプション)
NEXTAUTH_SECRET=your_nextauth_secret_here
NEXTAUTH_URL=http://localhost:3000
```

### 2. 実際の値を取得・設定

#### Supabase設定値の取得方法

1. [Supabase Dashboard](https://app.supabase.com/)にログイン
2. プロジェクトを選択
3. 「Settings」→「API」で以下を確認：
   - `NEXT_PUBLIC_SUPABASE_URL`: URL欄の値
   - `NEXT_PUBLIC_SUPABASE_ANON_KEY`: anon public欄の値  
   - `SUPABASE_SERVICE_ROLE_KEY`: service_role欄の値

#### OpenAI設定値の取得方法

1. [OpenAI Platform](https://platform.openai.com/)にログイン
2. 「API Keys」セクションで新しいキーを作成
3. `OPENAI_API_KEY`に設定

### 3. サーバー再起動

環境変数を設定後、開発サーバーを再起動してください：

```bash
# 現在のサーバーを停止（Ctrl+C）
# その後再度起動
npm run dev
```

## エラー確認方法

環境変数が正しく設定されているかを確認するため、以下のAPIを実行してください：

```bash
curl http://localhost:3000/api/check-env
```

## 修正されたコード

1. **OpenAIモデル名の修正**: `gpt-5-nano` → `gpt-3.5-turbo` に変更済み
2. **Next.jsバージョン更新**: `14.0.4` → `^14.2.0` に更新済み
3. **依存関係エラー**: npm依存関係を再インストール済み

## 次のステップ

環境変数設定後：
1. ボット一覧ページ（`http://localhost:3000/bots`）でボットが表示されるか確認
2. トップページ（`http://localhost:3000`）でボット情報が表示されるか確認
3. チャット機能が正常に動作するか確認

## トラブルシューティング

### ボットが表示されない場合

データベースにボットデータがない可能性があります。以下のAPIでボット数を確認：

```bash
curl http://localhost:3000/api/count-bots
```

ボットが0件の場合、以下のAPIでサンプルデータを挿入：

```bash
curl -X POST http://localhost:3000/api/register-csv-bots
```
